---
layout: post
title: Lenteurs MySQL sous linux (ext4)
tags:
- bruno
- admin
- linux
- mysql
status: publish
type: post
published: true
meta:
  _edit_last: '2'
---
Il y a quelques temps, nous avons constaté dans notre équipe des lenteurs très importantes lorsque nous faisions tourner nos tests unitaires. Le déroulement global qui prend entre 5 et 8 minutes (selon les machines), passait à 30 minutes voire plus.

La cause de ces lenteurs était l'utilisation d'un sytème de fichier en ext4 avec mysql suite à de nouvelles installations d'ubuntu. En effet, en ext4, une fonctionnalité ayant pour but de maintenir une meilleure intégrité des données a été activée par défaut, il s'agit des "write barriers". Pour contourner le problème il suffit de désactiver ces write barriers sur les montages utilisés par mysql (ici /opt) dans /etc/fstab : 
<pre language="bash">
/dev/sda2 on /opt type ext4 rw,barrier=0
</pre>
Cf : 
<ul>
	<li><a href="http://bugs.mysql.com/bug.php?id=46959">http://bugs.mysql.com/bug.php?id=46959</a></li>
	<li><a href="http://www.tedman.com/techie-notes/fedora12onthinkpadx61s">http://www.tedman.com/techie-notes/fedora12onthinkpadx61s</a></li>

</ul>

Edit : suppression des parenthèses après la remarque de Philippe
