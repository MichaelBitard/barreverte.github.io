---
layout: post
title: Exécuter la même commande sur plusieurs serveurs
tags:
- florence
- admin
- devops
- prete tes jouets
- ubuntu
status: publish
type: post
published: true
meta:
  _edit_last: '5'
---
Nous avons parfois besoin d'effectuer une même opération sur plusieurs serveurs. Les équipes exploitation connaissent bien cette problématique avec la multitude de frontaux à mettre à jour lors d'une mise en production.

Les développeurs aussi. Nous devons créer un répertoire sur les serveurs de recette et d'intégration; suite à un bogue, nous partons à la recherche d'informations dans les logs sur les cinq frontaux; nous avons besoin de comparer les logs de production avec ceux de recette, etc. Il y a au moins trois possibilités à ce type de besoin : le faire à la main à la suite; utiliser clusterSSH; ou Gnome Connection Manager.<!--more-->

<a title="ClusterSSH" href="http://sourceforge.net/projects/clusterssh/">ClusterSSH</a> permet d'exécuter une commande sur plusieurs machines en même temps, mais honnêtement, il y a mieux. Premièrement, le copier coller n'est pas possible. Deuxièmement, plus il y a de serveurs, plus les consoles sont petites. Avec cinq frontaux, on n'y voit plus rien.

<a href="http://blog.johanbleuzen.fr/">Johan</a> m'a fait découvrir <a title="Gnome Connection Manager" href="http://kuthulu.com/gcm/">Gnome Connection Manager</a>, qui permet de configurer les serveurs une fois pour toutes. Le fichier de configuration est sous SVN.

<a href="http://www.barreverte.fr/wp-content/uploads/2011/05/gnome1.png"><img class="aligncenter size-large wp-image-1975" title="gnome-connection-1" src="http://www.barreverte.fr/wp-content/uploads/2011/05/gnome1-1024x549.png" alt="" width="640" height="343" /></a>Surtout, il permet d'exécuter des commandes sur des clusters de serveurs.

<a href="http://www.barreverte.fr/wp-content/uploads/2011/05/gnome21.png"><img class="aligncenter size-large wp-image-1979" title="gnome-connection-2" src="http://www.barreverte.fr/wp-content/uploads/2011/05/gnome21-1024x76.png" alt="" width="640" height="47" /></a>Il suffit d'appuyer sur <em>[Entrée]</em> pour envoyer la commande.

<a href="http://www.barreverte.fr/wp-content/uploads/2011/05/gnome3.png"><img class="aligncenter size-large wp-image-1978" title="gnome-connection-3" src="http://www.barreverte.fr/wp-content/uploads/2011/05/gnome3-1024x547.png" alt="" width="640" height="341" /></a>

L'application s'installe très simplement avec Ubuntu, ce serait dommage de s'en priver. Personnellement, je ne peux plus m'en passer pour les commandes groupées.
<h2>Liens</h2>
GnomeConnectionManager : <a href="http://kuthulu.com/gcm/">http://kuthulu.com/gcm/</a>
ClusterSSH : <a href="http://sourceforge.net/projects/clusterssh/">http://sourceforge.net/projects/clusterssh/</a>
Multitail : <a href="http://www.vanheusden.com/multitail/">http://www.vanheusden.com/multitail/
</a>
<em>[Edit du 24 Mai, suite aux remarques de JP]</em>
Puppet : <a rel="nofollow" href="http://www.puppetlabs.com/puppet/introduction/" target="_blank">http://www.puppetlabs.com/puppet/introduction</a>
Chef : <a rel="nofollow" href="http://www.opscode.com/chef/" target="_blank">http://www.opscode.com/chef</a>
CF Engine : <a rel="nofollow" href="http://www.cfengine.org/" target="_blank">http://www.cfengine.org</a>
=&gt; plus rien n'est manuel, tout est dans svn/git, tout est répétable. Dans ma boite, nous avons eu des surprises en production avec puppet., suite à des modifications "automatiques".
